{"mappings":"ACKA,IAAI,EAAiB,EAErB,MAAM,EAAe,AAAC,IACpB,IAAM,EAAS,IAAI,cAAc,MAAM,CAAC,GAClC,EAAU,EAAM,EAAO,MAAM,CAAG,GACtC,GAAI,AAAW,GAAX,EACF,MAAM,iBAER,IAAM,EAAQ,IAAI,WAChB,EAAO,MAAM,CACb,EACA,EAAO,MAAM,CAAG,GAIlB,OAFA,EAAM,GAAG,CAAC,GACV,CAAK,CAAC,EAAO,MAAM,CAAC,CAAG,EAChB,CACT,EAEM,EAAe,CAAC,EAAS,KAC7B,IAAM,EAAQ,IAAI,WAChB,EAAO,MAAM,CACb,EACA,GAEF,OAAO,IAAI,cAAc,MAAM,CAAC,EAClC,EAEA,IAAI,EAAQ,CAAA,EAEZ,KAAM,CACJ,SAAU,CACR,QAAS,CAAA,OAAE,CAAM,CAAA,SAAE,CAAQ,CAAA,MAAE,CAAK,CAAE,CACrC,CACF,CAAG,MAAM,YAAY,oBAAoB,CAAC,MAAM,qBAAsB,CACrE,IAAK,CACH,MAAO,CAAC,EAAS,KACf,IAAM,EAAS,EAAa,EAAS,GACrC,QAAQ,GAAG,CAAC,CAAC,EAAE,EAAO,CAAC,CACzB,EACA,WAAY,CAAC,EAAS,KACpB,IAAM,EAAS,EAAa,EAAS,EACrC,CAAA,EAAS,SAAS,CAChB,0EACA,EACA,SACF,EAAQ,CAAA,CACV,CACF,CACF,GAEA,QAAQ,GAAG,CAAC,EAAS,EAAa,SAAU,IAE5C,IAAI,EAAQ,OAAO,QAAQ,CAAC,cAAc,CAAC,SACvC,EAAO,OAAO,QAAQ,CAAC,cAAc,CAAC,QACtC,EAAW,OAAO,QAAQ,CAAC,cAAc,CAAC,aAE9C,EAAK,gBAAgB,CAAC,SAEtB,SAA2B,CAAC,EAC1B,EAAE,cAAc,GAChB,IAAM,EASC,EAAS,EATc,EAAM,KAAK,EASA,GARpC,IACH,EAAiB,EACjB,EAAM,KAAK,CAAG,GAEhB,EAAQ,CAAA,CACV,GAMA,OAAO,gBAAgB,CAAC,QAAS,KAC/B,IAAM,EAJC,EAAS,EAIe,EAAM,KAAK,EAJD,GAKpC,GACH,CAAA,EAAS,SAAS,CAChB,iFACA,EACA,QAJJ,EAMA,EAAQ,CAAA,CACV","sources":["<anon>","src/js/main.js"],"sourcesContent":["var $54b47fc030b7b21e$exports = {};\n/// TODO:\n/// - Save and reload equations\n/// - Make it look more like a fullscreen calculator/speedcrunch\n/// - Make upstream support exponential notation\nvar $54b47fc030b7b21e$var$previousAnswer = 0;\nconst $54b47fc030b7b21e$var$encodeString = (string)=>{\n    const buffer = new TextEncoder().encode(string);\n    const pointer = $54b47fc030b7b21e$var$alloc(buffer.length + 1); // ask Zig to allocate memory\n    if (pointer == 0) throw allocationFailed;\n    const slice = new Uint8Array($54b47fc030b7b21e$var$memory.buffer, pointer, buffer.length + 1);\n    slice.set(buffer);\n    slice[buffer.length] = 0; // null byte to null-terminate the string\n    return pointer;\n};\nconst $54b47fc030b7b21e$var$decodeString = (pointer, length)=>{\n    const slice = new Uint8Array($54b47fc030b7b21e$var$memory.buffer, pointer, length);\n    return new TextDecoder().decode(slice);\n};\nvar $54b47fc030b7b21e$var$error = false;\nconst { instance: { exports: { memory: $54b47fc030b7b21e$var$memory, evaluate: $54b47fc030b7b21e$var$evaluate, alloc: $54b47fc030b7b21e$var$alloc } } } = await WebAssembly.instantiateStreaming(fetch(\"./Calculator.wasm\"), {\n    env: {\n        print: (pointer, length)=>{\n            const string = $54b47fc030b7b21e$var$decodeString(pointer, length);\n            console.log(`${string}`);\n        },\n        inputError: (pointer, length)=>{\n            const string = $54b47fc030b7b21e$var$decodeString(pointer, length);\n            $54b47fc030b7b21e$var$lowerRow.innerHTML = \"<div class='alert alert-danger mb-0' data-bs-theme='dark' role='alert'>\" + string + \"</div>\";\n            $54b47fc030b7b21e$var$error = true;\n        }\n    }\n});\nconsole.log($54b47fc030b7b21e$var$evaluate($54b47fc030b7b21e$var$encodeString(\"10+10\"), 0));\nvar $54b47fc030b7b21e$var$input = window.document.getElementById(\"input\");\nvar $54b47fc030b7b21e$var$form = window.document.getElementById(\"form\");\nvar $54b47fc030b7b21e$var$lowerRow = window.document.getElementById(\"lower-row\");\n$54b47fc030b7b21e$var$form.addEventListener(\"submit\", $54b47fc030b7b21e$var$processSubmission);\nfunction $54b47fc030b7b21e$var$processSubmission(e) {\n    e.preventDefault();\n    const value = $54b47fc030b7b21e$var$calculateResult($54b47fc030b7b21e$var$input.value);\n    if (!$54b47fc030b7b21e$var$error) {\n        $54b47fc030b7b21e$var$previousAnswer = value;\n        $54b47fc030b7b21e$var$input.value = value;\n    }\n    $54b47fc030b7b21e$var$error = false;\n}\nfunction $54b47fc030b7b21e$var$calculateResult(userInput) {\n    return $54b47fc030b7b21e$var$evaluate($54b47fc030b7b21e$var$encodeString(userInput), $54b47fc030b7b21e$var$previousAnswer);\n}\nwindow.addEventListener(\"keyup\", ()=>{\n    const result = $54b47fc030b7b21e$var$calculateResult($54b47fc030b7b21e$var$input.value);\n    if (!$54b47fc030b7b21e$var$error) $54b47fc030b7b21e$var$lowerRow.innerHTML = \"<div class='alert alert-dark mb-0 text-end' data-bs-theme='dark' role='alert'>\" + result + \"</div>\";\n    $54b47fc030b7b21e$var$error = false;\n});\n\n\n//# sourceMappingURL=index.f70ac879.js.map\n","/// TODO:\n/// - Save and reload equations\n/// - Make it look more like a fullscreen calculator/speedcrunch\n/// - Make upstream support exponential notation\n\nvar previousAnswer = 0;\n\nconst encodeString = (string) => {\n  const buffer = new TextEncoder().encode(string);\n  const pointer = alloc(buffer.length + 1); // ask Zig to allocate memory\n  if (pointer == 0) {\n    throw allocationFailed;\n  }\n  const slice = new Uint8Array(\n    memory.buffer, // memory exported from Zig\n    pointer,\n    buffer.length + 1\n  );\n  slice.set(buffer);\n  slice[buffer.length] = 0; // null byte to null-terminate the string\n  return pointer;\n};\n\nconst decodeString = (pointer, length) => {\n  const slice = new Uint8Array(\n    memory.buffer, //\n    pointer,\n    length\n  );\n  return new TextDecoder().decode(slice);\n};\n\nvar error = false;\n\nconst {\n  instance: {\n    exports: { memory, evaluate, alloc },\n  },\n} = await WebAssembly.instantiateStreaming(fetch(\"./Calculator.wasm\"), {\n  env: {\n    print: (pointer, length) => {\n      const string = decodeString(pointer, length);\n      console.log(`${string}`);\n    },\n    inputError: (pointer, length) => {\n      const string = decodeString(pointer, length);\n      lowerRow.innerHTML =\n        \"<div class='alert alert-danger mb-0' data-bs-theme='dark' role='alert'>\" +\n        string +\n        \"</div>\";\n      error = true;\n    },\n  },\n});\n\nconsole.log(evaluate(encodeString(\"10+10\"), 0));\n\nvar input = window.document.getElementById(\"input\");\nvar form = window.document.getElementById(\"form\");\nvar lowerRow = window.document.getElementById(\"lower-row\");\n\nform.addEventListener(\"submit\", processSubmission);\n\nfunction processSubmission(e) {\n  e.preventDefault();\n  const value = calculateResult(input.value);\n  if (!error) {\n    previousAnswer = value;\n    input.value = value;\n  }\n  error = false;\n}\n\nfunction calculateResult(userInput) {\n  return evaluate(encodeString(userInput), previousAnswer);\n}\n\nwindow.addEventListener(\"keyup\", () => {\n  const result = calculateResult(input.value);\n  if (!error) {\n    lowerRow.innerHTML =\n      \"<div class='alert alert-dark mb-0 text-end' data-bs-theme='dark' role='alert'>\" +\n      result +\n      \"</div>\";\n  }\n  error = false;\n});\n"],"names":["$54b47fc030b7b21e$var$previousAnswer","$54b47fc030b7b21e$var$encodeString","string","buffer","TextEncoder","encode","pointer","$54b47fc030b7b21e$var$alloc","length","allocationFailed","slice","Uint8Array","$54b47fc030b7b21e$var$memory","set","$54b47fc030b7b21e$var$decodeString","TextDecoder","decode","$54b47fc030b7b21e$var$error","instance","exports","memory","evaluate","$54b47fc030b7b21e$var$evaluate","alloc","WebAssembly","instantiateStreaming","fetch","env","print","console","log","inputError","$54b47fc030b7b21e$var$lowerRow","innerHTML","$54b47fc030b7b21e$var$input","window","document","getElementById","$54b47fc030b7b21e$var$form","addEventListener","e","preventDefault","value","result"],"version":3,"file":"index.f70ac879.js.map"}